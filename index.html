<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Catálogo — Camisetas de Fútbol</title>
  <style>
    :root{
      --bg: #0b0d10;
      --panel: #111418;
      --panel-2: #151a1f;
      --text: #e6e8eb;
      --muted: #a8b0b9;
      --brand: #29b457;
      --brand-2: #2ad38c;
      --danger: #ff5d5d;
      --ring: 0 0 0 3px rgba(42, 211, 140, 0.25);
      --radius: 16px;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --max-width: 1220px;
    }

    /* Reset y utilidades */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, #0b0d10, #0e1116 40%, #0b0d10);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.3;
    }
    a{color:inherit; text-decoration:none}

    /* Contenedor principal */
    .site-container{max-width:var(--max-width); margin:0 auto; padding:0 16px}

    /* ====================
       HEADER / HERO
       ====================
       - .header-bar: barra superior fija y profesional
       - .header-row: layout interno del header
       - .site-brand / .logo-badge: marca y logo
       - .nav-leagues: nav compacto por ligas
       - .header-actions: búsqueda, cuenta y carrito
    */
    header.header-bar{
      position:sticky; top:0; z-index:60;
      backdrop-filter: blur(8px);
      background: rgba(11,13,16,.7); border-bottom: 1px solid #172024;
    }
    .header-row{display:flex; align-items:center; gap:18px; padding:12px 0}
    .site-brand{display:flex; align-items:center; gap:12px; font-weight:800}
    .logo-badge{
      width:44px; height:44px; border-radius:10px; display:grid; place-items:center; font-weight:900; color:#0b0d10;
      background: radial-gradient(100% 100% at 0% 0%, var(--brand-2), var(--brand));
      box-shadow: 0 6px 22px rgba(42,211,140,.25);
      font-size:16px;
    }
    .brand-lines{line-height:1}
    .brand-title{font-size:16px; opacity:.95}
    .brand-sub{font-size:12px; color:var(--muted)}

    /* Nav ligas rápido (pills) */
    nav.nav-leagues{margin-left:12px; display:flex; gap:8px; flex-wrap:wrap}
    .pill-nav{padding:8px 12px; border-radius:999px; background:linear-gradient(180deg,#0f1318,#0c0f12); border:1px solid #172024; font-weight:700; font-size:13px}
    .pill-nav:hover{border-color:#213034; cursor:pointer}

    /* Header acciones: búsqueda compacta, cuenta, carrito */
    .header-actions{margin-left:auto; display:flex; gap:10px; align-items:center}
    .search-compact{min-width:220px}
    .search-compact input{width:100%; padding:8px 10px; border-radius:10px; border:1px solid #27303a; background:#0e1318; color:var(--text)}
    .action-icon{padding:8px 10px; border-radius:10px; border:1px solid transparent; background:transparent; cursor:pointer}
    .cart-badge{position:relative}
    .cart-count{position:absolute; top:-6px; right:-6px; background:var(--danger); color:#fff; border-radius:999px; padding:2px 6px; font-size:11px; font-weight:700}

    /* HERO / cabecera de la página principal (debajo del header) */
    .hero{
      margin-top:18px; margin-bottom:6px;
      display:flex; align-items:center; justify-content:space-between; gap:16px;
      padding:18px; border-radius:14px; background: linear-gradient(90deg, rgba(42,211,140,0.05), transparent);
      border:1px solid rgba(42,211,140,0.04);
    }
    .hero-left{max-width:65%}
    .hero-title{font-size:20px; font-weight:900; margin:0 0 6px}
    .hero-sub{color:var(--muted); margin:0}
    .hero-cta{display:flex; gap:8px; margin-top:10px}

    /* ====================
       LAYOUT PRINCIPAL
       ==================== */
    .main-layout{display:grid; grid-template-columns: 300px 1fr; gap:18px; padding:18px 0 36px}
    @media (max-width: 980px){
      .main-layout{grid-template-columns: 1fr}
      aside.sidebar-panel{position:static}
    }

    /* SIDEBAR (filtros) */
    aside.sidebar-panel{position:sticky; top:110px; align-self:start}
    .panel{background:linear-gradient(180deg,#12171d,#0f1318); border:1px solid #172024; border-radius:var(--radius); padding:16px; box-shadow: var(--shadow)}
    .panel h3{margin:0 0 12px; font-size:16px; color:#e9edf2}

    .form-control{display:flex; flex-direction:column; gap:8px; margin:10px 0}
    label{font-size:13px; color:var(--muted)}
    select,input[type="text"],input[type="number"],input[type="range"]{
      width:100%; padding:10px 12px; border-radius:12px; border:1px solid #27303a; background:#0e1318; color:var(--text);
    }
    select:focus, input:focus{outline:none; box-shadow: var(--ring); border-color:#2ad38c55}

    .panel-actions{display:flex; gap:8px; margin-top:8px}
    .btn{cursor:pointer; border:none; border-radius:12px; padding:10px 12px; font-weight:700}
    .btn-primary{background:linear-gradient(135deg, var(--brand-2), var(--brand)); color:#0b0d10}
    .btn-ghost{background:transparent; color:var(--text); border:1px solid #27303a}

    /* TOOLBAR DEL CONTENIDO */
    .toolbar{display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin:6px 0 12px}
    .searchwide{flex:1; min-width:220px}
    .searchwide input{width:100%; padding:10px 12px; border-radius:12px; border:1px solid #27303a; background:#0e1318; color:var(--text)}
    .sort-select{min-width:200px}

    /* GRID DE PRODUCTOS */
    .products-grid{display:grid; grid-template-columns: repeat(3, 1fr); gap:16px}
    @media (max-width: 1100px){.products-grid{grid-template-columns: repeat(2, 1fr)}}
    @media (max-width: 700px){.products-grid{grid-template-columns: 1fr}}

    /* TARJETA DE PRODUCTO */
    .product-card{
      border-radius: 18px; overflow:hidden; border:1px solid #172024; background:linear-gradient(180deg,#10151a,#0f1317);
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease; display:flex; flex-direction:column;
    }
    .product-card:hover{transform: translateY(-3px); box-shadow:0 12px 30px rgba(0,0,0,.45); border-color:#21323a}
    .product-thumb{aspect-ratio: 4/3; background: radial-gradient(120% 120% at 0% 0%, #1a2430, #0f1318); display:grid; place-items:center}
    .jersey-svg{width:64%}
    .product-info{padding:12px 14px; display:flex; flex-direction:column; gap:8px}
    .product-meta{display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:12px}
    .product-title{font-size:15px; font-weight:800; margin:6px 0}
    .product-price{font-size:16px; font-weight:900}
    .product-tags{display:flex; gap:6px; flex-wrap:wrap; margin-top:6px}
    .product-tag{font-size:11px; padding:4px 8px; border:1px solid #223034; border-radius:999px; color:#cfd6dd}
    .product-actions{display:flex; gap:8px; margin-top:12px; margin-left:auto}

    /* MODAL de producto */
    .modal-overlay{position:fixed; inset:0; background: rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; padding:20px}
    .modal-overlay.open{display:flex}
    .modal-content{max-width:820px; width:100%; background:#0f1318; border:1px solid #233238; border-radius:18px; overflow:hidden; display:grid; grid-template-columns: 1.3fr 1fr}
    @media (max-width: 860px){.modal-content{grid-template-columns:1fr}}
    .modal-media{background: radial-gradient(120% 120% at 0% 0%, #1a2430, #0f1318); display:grid; place-items:center; padding:18px}
    .modal-body{padding:18px; position:relative}
    .modal-close{position:absolute; top:14px; right:14px; background:transparent; border:1px solid #233238; color:#cbd3db; border-radius:12px; padding:8px 10px; cursor:pointer}

    /* TOAST/NOTIFICACIONES */
    #toast-msg{position:fixed; bottom:20px; right:20px; background:#0f1318; border:1px solid #233238; padding:12px 14px; border-radius:12px; display:none}
    #toast-msg.show{display:block}

    /* FOOTER */
    footer{border-top:1px solid #172024; color:#9aa3ad; font-size:13px}
    footer .site-container{display:flex; justify-content:space-between; gap:12px; padding:18px 16px}
  </style>
</head>
<body>
  <!-- ====================
       HEADER
       ==================== 
       Comentarios: Cabecera profesional con marca, nav por ligas, búsqueda y acciones (cuenta + carrito).
  -->
  <header class="header-bar">
    <div class="site-container header-row">
      <div class="site-brand" aria-label="Fútbol Camisetas">
        <div class="logo-badge" aria-hidden="true">FC</div>
        <div class="brand-lines">
          <div class="brand-title">Fútbol Camisetas</div>
          <div class="brand-sub">Ligas, equipos y temporadas</div>
        </div>
      </div>

      <!-- Navegación rápida por ligas (se rellena por JS) -->
      <nav class="nav-leagues" id="navLeagues" aria-label="Navegación ligas"></nav>

      <!-- Acciones del header: búsqueda compacta, cuenta y carrito -->
      <div class="header-actions">
        <div class="search-compact" title="Buscar en el catálogo">
          <input id="inputHeaderSearch" placeholder="Buscar camisetas, jugadores, temporadas…" />
        </div>
        <button class="action-icon" id="btnAccount" title="Mi cuenta">Cuenta</button>

        <div class="cart-badge" title="Ver carrito">
          <button class="action-icon" id="btnViewCart">Carrito</button>
          <span class="cart-count" id="cartCount">0</span>
        </div>
      </div>
    </div>
  </header>

  <!-- HERO (introducción breve) -->
  <div class="site-container">
    <section class="hero panel" aria-hidden="false">
      <div class="hero-left">
        <h1 class="hero-title">Catálogo de camisetas oficiales — Temporadas recientes</h1>
        <p class="hero-sub">Encuentra camisetas de tus equipos favoritos: local, visitante y ediciones especiales. Envío rápido y pago seguro.</p>
        <div class="hero-cta">
          <button class="btn btn-primary" id="btnShopNow">Ver catálogo</button>
          <button class="btn btn-ghost" id="btnPromo">Ofertas</button>
        </div>
      </div>
      <div class="hero-right" style="text-align:right; color:var(--muted)">
        <div style="font-weight:700">Atención al cliente</div>
        <div style="font-size:13px; margin-top:6px">Lunes - Viernes · 09:00 - 18:00</div>
      </div>
    </section>
  </div>

  <!-- ====================
       CONTENIDO PRINCIPAL: SIDEBAR (FILTROS) + RESULTADOS
       ==================== -->
  <main class="site-container main-layout" id="mainLayout">
    <!-- SIDEBAR: filtros -->
    <aside class="sidebar-panel">
      <div class="panel" aria-labelledby="panelFiltersTitle">
        <h3 id="panelFiltersTitle">Filtros</h3>

        <div class="form-control">
          <label for="selectLeague">Liga</label>
          <select id="selectLeague" aria-controls="selectTeam"></select>
        </div>

        <div class="form-control">
          <label for="selectTeam">Equipo</label>
          <select id="selectTeam"><option value="">Todos</option></select>
        </div>

        <div class="form-control">
          <label for="inputSearch">Buscar (equipo, jugador, temporada)</label>
          <input id="inputSearch" type="text" placeholder="Ej. Barcelona 2025, Haaland" />
        </div>

        <!-- Rango de precio (antes faltaba en el HTML, JS lo referenciaba) -->
        <div class="form-control">
          <label for="inputPriceMax">Precio máximo (€) <span id="labelPriceMax" style="color:var(--muted); font-size:13px">200</span></label>
          <input id="inputPriceMax" type="range" min="10" max="200" value="200" />
        </div>

        <div class="panel-actions">
          <button class="btn btn-primary" id="btnApplyFilters">Aplicar</button>
          <button class="btn btn-ghost" id="btnClearFilters">Limpiar</button>
        </div>
      </div>
    </aside>

    <!-- CONTENIDO: toolbar + resultados -->
    <section>
      <!-- Toolbar: búsqueda extensa y orden -->
      <div class="toolbar">
        <div class="searchwide">
          <input id="inputQuickSearch" type="text" placeholder="Buscar rápido…" />
        </div>
        <div class="sort-select">
          <select id="selectSort">
            <option value="popular">Ordenar: Popularidad</option>
            <option value="priceAsc">Precio (menor a mayor)</option>
            <option value="priceDesc">Precio (mayor a menor)</option>
            <option value="seasonDesc">Temporada (más reciente)</option>
          </select>
        </div>
        <button class="pill-nav" id="btnResetFilters">Reiniciar filtros</button>
      </div>

      <!-- Meta resultados -->
      <div id="resultsMeta" style="color:var(--muted); font-size:13px; margin:6px 0 12px"></div>

      <!-- Grid de productos -->
      <div class="products-grid" id="gridProducts" aria-live="polite"></div>
    </section>
  </main>

  <!-- ====================
       MODAL: vista de producto
       ====================
       Comentarios: modal con detalles, botón añadir al carrito (id: btnAddToCart) y compartir.
  -->
  <div class="modal-overlay" id="modalProduct" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-media" id="modalMedia"></div>
      <div class="modal-body">
        <button class="modal-close" id="btnCloseModal" aria-label="Cerrar">✕</button>
        <h3 id="modalTitle"></h3>
        <div style="color:var(--muted); font-size:13px" id="modalMeta"></div>
        <div class="product-tags" id="modalTags" style="margin-top:10px"></div>

        <div style="display:flex; align-items:center; gap:10px; margin-top:12px">
          <strong class="product-price" id="modalPrice"></strong>
          <span style="color:var(--muted); font-size:12px">Impuestos incluidos</span>
        </div>

        <div class="form-control" style="margin-top:12px">
          <label for="selectSize">Talla</label>
          <select id="selectSize">
            <option>S</option>
            <option>M</option>
            <option>L</option>
            <option>XL</option>
          </select>
        </div>

        <div style="display:flex; gap:8px; margin-top:12px">
          <button class="btn btn-primary" id="btnAddToCart">Añadir al carrito</button>
          <button class="btn btn-ghost" id="btnShare">Compartir</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast / notificación -->
  <div id="toast-msg" role="status" aria-live="polite"></div>

  <!-- Footer -->
  <footer>
    <div class="site-container">
      <div>© <span id="footerYear"></span> Streetwear Store - Fútbol Camisetas</div>
      <div>Hecho con pasión por el fútbol ⚽</div>
    </div>
  </footer>

  <!-- ====================
       SCRIPT: lógica del catálogo y UI
       ====================
       Comentarios principales:
       - Todos los selectores se han renombrado para facilitar edición en CSS/JS.
       - state mantiene filtros y estado de carrito.
       - init() inicializa eventos y rellena selects/nav.
       - render() filtra, ordena y pinta tarjetas.
       - openModal/closeModal gestionan el modal de producto.
  -->
  <script>
    /* ==========
       DATOS: catálogo de ejemplo
       ==========
       - catalog: array de objetos con información de cada camiseta
       - leagueTeams: mapa liga -> equipos (se usa para rellenar select de equipos)
    */
    const catalog = [
      { id: 'laliga-barca-25-home', name: 'FC Barcelona Local 2024/25', league: 'LaLiga', team: 'FC Barcelona', season: '2024/25', kit: 'Local', price: 119, tags:['Nike','Jugador: Pedri'] },
      { id: 'laliga-madrid-25-away', name: 'Real Madrid Visitante 2024/25', league: 'LaLiga', team: 'Real Madrid', season: '2024/25', kit: 'Visitante', price: 115, tags:['adidas','Jugador: Bellingham'] },
      { id: 'laliga-atleti-24-home', name: 'Atlético de Madrid Local 2023/24', league: 'LaLiga', team: 'Atlético de Madrid', season: '2023/24', kit: 'Local', price: 99, tags:['Nike'] },

      { id: 'prem-city-25-home', name: 'Manchester City Local 2024/25', league: 'Premier League', team: 'Manchester City', season: '2024/25', kit: 'Local', price: 120, tags:['Puma','Jugador: Haaland'] },
      { id: 'prem-united-24-third', name: 'Manchester United Tercera 2023/24', league: 'Premier League', team: 'Manchester United', season: '2023/24', kit: 'Tercera', price: 89, tags:['adidas'] },
      { id: 'prem-arsenal-25-away', name: 'Arsenal Visitante 2024/25', league: 'Premier League', team: 'Arsenal', season: '2024/25', kit: 'Visitante', price: 110, tags:['adidas','Jugador: Saka'] },

      { id: 'seriea-juve-25-home', name: 'Juventus Local 2024/25', league: 'Serie A', team: 'Juventus', season: '2024/25', kit: 'Local', price: 109, tags:['adidas'] },
      { id: 'seriea-milan-24-away', name: 'AC Milan Visitante 2023/24', league: 'Serie A', team: 'AC Milan', season: '2023/24', kit: 'Visitante', price: 92, tags:['Puma'] },

      { id: 'bund-bayern-25-home', name: 'Bayern München Local 2024/25', league: 'Bundesliga', team: 'Bayern München', season: '2024/25', kit: 'Local', price: 119, tags:['adidas'] },
      { id: 'bund-dortmund-24-home', name: 'Borussia Dortmund Local 2023/24', league: 'Bundesliga', team: 'Borussia Dortmund', season: '2023/24', kit: 'Local', price: 95, tags:['Puma'] },

      { id: 'ligue1-psg-25-home', name: 'PSG Local 2024/25', league: 'Ligue 1', team: 'Paris Saint-Germain', season: '2024/25', kit: 'Local', price: 125, tags:['Nike','Jugador: Mbappé'] },
      { id: 'ligue1-marseille-24-away', name: 'Olympique Marsella Visitante 2023/24', league: 'Ligue 1', team: 'Olympique de Marsella', season: '2023/24', kit: 'Visitante', price: 88, tags:['Puma'] },
    ];

    const leagueTeams = {
      'LaLiga': ['FC Barcelona','Real Madrid','Atlético de Madrid','Sevilla','Real Sociedad','Valencia'],
      'Premier League': ['Manchester City','Manchester United','Arsenal','Chelsea','Liverpool','Tottenham'],
      'Serie A': ['Juventus','Inter','AC Milan','Napoli','Roma','Lazio'],
      'Bundesliga': ['Bayern München','Borussia Dortmund','RB Leipzig','Bayer Leverkusen','Eintracht Frankfurt'],
      'Ligue 1': ['Paris Saint-Germain','Olympique de Marsella','Olympique Lyon','AS Monaco','Lille']
    };

    /* ==========
       SELECTORES CORTOS
       Comentario: función helper para seleccionar elementos por selector CSS.
    */
    const $ = s => document.querySelector(s);
    const el = (tag, attrs={}) => Object.assign(document.createElement(tag), attrs);

    /* ==========
       SVG de camiseta reutilizable
       - Se devuelve un nodo SVG para inyectar en las miniaturas y modal
    */
    function jerseySVG(){
      const wrapper = el('div');
      wrapper.innerHTML = `
        <svg class="jersey-svg" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#2ad38c"/>
              <stop offset="100%" stop-color="#29b457"/>
            </linearGradient>
          </defs>
          <path fill="url(#g)" d="M160 64l-48 32-64 16 24 104 64-16v208c0 26.5 21.5 48 48 48h192c26.5 0 48-21.5 48-48V200l64 16 24-104-64-16-48-32-64 40h-64l-64-40z"/>
        </svg>`;
      return wrapper.firstElementChild;
    }

    /* ==========
       Estado de la UI
       - Guarda filtros, orden y carrito
    */
    const state = {
      league: '',      // liga seleccionada
      team: '',        // equipo seleccionado
      search: '',      // búsqueda (aplicada)
      priceMax: 200,   // precio máximo
      sort: 'popular', // criterio de orden
      cartCount: 0,    // contador de carrito
    };

    /* ==========
       Inicialización: configurar UI, eventos y render inicial
       - Rellena nav y selects
       - Añade listeners para interactividad
    */
    function init(){
      // año en el footer
      $('#footerYear').textContent = new Date().getFullYear();

      // Rellenar nav de ligas (pills) — elemento: #navLeagues
      const nav = $('#navLeagues');
      Object.keys(leagueTeams).forEach(l => {
        const a = el('button', {className:'pill-nav', type:'button'});
        a.textContent = l;
        a.addEventListener('click', ()=>{ state.league = l; syncFiltersFromState(); render(); scrollToTop();});
        nav.appendChild(a);
      });

      // Select Liga (#selectLeague)
      const leagueSelect = $('#selectLeague');
      leagueSelect.innerHTML = `<option value="">Todas</option>` + Object.keys(leagueTeams).map(l=>`<option value="${l}">${l}</option>`).join('');
      leagueSelect.addEventListener('change', e=>{ state.league = e.target.value; updateTeamOptions(); });

      // Select Equipo (#selectTeam)
      $('#selectTeam').addEventListener('change', e=>{ state.team = e.target.value; });

      // Rango de precio (#inputPriceMax)
      const price = $('#inputPriceMax');
      const priceLabel = $('#labelPriceMax');
      price.addEventListener('input', e=>{ priceLabel.textContent = e.target.value; state.priceMax = +e.target.value; });

      // Buscadores
      $('#inputSearch').addEventListener('input', e=>{ state.search = e.target.value; });
      $('#inputQuickSearch').addEventListener('input', e=>{ state.search = e.target.value; render(); });

      // Cabecera: búsqueda compacta en header (solo sincroniza la búsqueda)
      $('#inputHeaderSearch').addEventListener('input', e => { state.search = e.target.value; render(); });

      // Sort
      $('#selectSort').addEventListener('change', e=>{ state.sort = e.target.value; render();});

      // Acciones botones filtros
      $('#btnApplyFilters').addEventListener('click', ()=> render());
      $('#btnClearFilters').addEventListener('click', ()=> { resetFilters(); render(); });
      $('#btnResetFilters').addEventListener('click', ()=> { resetFilters(); render(); });

      // Botones del header/hero
      $('#btnShopNow').addEventListener('click', ()=> { resetFilters(); render(); scrollToTop(); });
      $('#btnViewCart').addEventListener('click', ()=>{ toast(`Tienes ${state.cartCount} artículo(s) en el carrito`); });

      // Modal
      $('#btnCloseModal').addEventListener('click', closeModal);
      $('#modalProduct').addEventListener('click', (e)=>{ if(e.target.id==='modalProduct') closeModal(); });

      // Botón añadir al carrito (modal)
      $('#btnAddToCart').addEventListener('click', ()=>{ state.cartCount++; $('#cartCount').textContent = state.cartCount; toast('Añadido al carrito'); });

      // Compartir (modal)
      $('#btnShare').addEventListener('click', async ()=>{
        try{
          const data = $('#modalTitle').textContent + ' — ' + $('#modalMeta').textContent;
          await navigator.clipboard.writeText(data);
          toast('Información copiada al portapapeles');
        }catch{ toast('No se pudo compartir'); }
      });

      // Inicializar lista de equipos y renderizar
      updateTeamOptions();
      syncFiltersFromState();
      render();
    }

    /* ==========
       Rellena el select de equipos según la liga seleccionada
       - si no hay liga, muestra todos los equipos únicos
    */
    function updateTeamOptions(){
      const teamSel = $('#selectTeam');
      const league = state.league;
      const teams = league ? (leagueTeams[league] || []) : Object.values(leagueTeams).flat();
      const unique = [...new Set(teams)];
      const opts = ['<option value="">Todos</option>', ...unique.map(t=>`<option value="${t}">${t}</option>`)];
      teamSel.innerHTML = opts.join('');
    }

    /* ==========
       Reset filtros a valores por defecto
    */
    function resetFilters(){
      state.league = '';
      state.team = '';
      state.search = '';
      state.priceMax = 200;
      state.sort = 'popular';
      syncFiltersFromState();
    }

    /* ==========
       Sincroniza los inputs/selects visibles con el estado JS
    */
    function syncFiltersFromState(){
      $('#selectLeague').value = state.league;
      updateTeamOptions();
      $('#selectTeam').value = state.team;
      $('#inputSearch').value = state.search;
      $('#inputQuickSearch').value = state.search;
      $('#inputHeaderSearch').value = state.search;
      $('#inputPriceMax').value = state.priceMax; $('#labelPriceMax').textContent = state.priceMax;
      $('#selectSort').value = state.sort;
      $('#cartCount').textContent = state.cartCount;
    }

    /* ==========
       Render: filtra, ordena y pinta las tarjetas de producto en #gridProducts
    */
    function render(){
      let items = catalog.filter(p => p.price <= state.priceMax);

      if(state.league) items = items.filter(p => p.league === state.league);
      if(state.team)   items = items.filter(p => p.team === state.team);

      if(state.search){
        const q = state.search.toLowerCase();
        items = items.filter(p => (
          p.name.toLowerCase().includes(q) ||
          p.team.toLowerCase().includes(q) ||
          p.season.toLowerCase().includes(q) ||
          p.tags.join(' ').toLowerCase().includes(q)
        ));
      }

      // Orden
      if(state.sort === 'priceAsc') items.sort((a,b)=> a.price - b.price);
      else if(state.sort === 'priceDesc') items.sort((a,b)=> b.price - a.price);
      else if(state.sort === 'seasonDesc') items.sort((a,b)=> seasonValue(b.season) - seasonValue(a.season));
      else /* popular */ items.sort(()=> Math.random() - .5);

      const grid = $('#gridProducts'); grid.innerHTML = '';
      items.forEach(p => grid.appendChild(productCard(p)));

      $('#resultsMeta').textContent = `${items.length} resultado${items.length!==1?'s':''}${state.league?` en ${state.league}`:''}${state.team?` · ${state.team}`:''}`;
    }

    /* ==========
       Auxiliar para ordenar temporadas (ej: "2024/25" => 2024.25)
    */
    function seasonValue(s){
      const m = /^(\d{4})\/(\d{2})$/.exec(s);
      if(!m) return 0;
      return parseInt(m[1]) + parseInt(m[2])/100;
    }

    /* ==========
       Construye DOM de una tarjeta de producto
       - p: objeto producto
       - usa clases claras (.product-card, .product-thumb, .product-info, etc.)
    */
    function productCard(p){
      const card = el('article', {className:'product-card', role:'article'});
      const thumb = el('div', {className:'product-thumb'});
      thumb.appendChild(jerseySVG());

      const info = el('div', {className:'product-info'});
      const meta = el('div', {className:'product-meta'});
      meta.innerHTML = `<span>${p.league}</span><span>${p.season}</span>`;

      const title = el('div', {className:'product-title'}); title.textContent = p.name;
      const price = el('div', {className:'product-price'}); price.textContent = p.price.toFixed(0) + '€';

      const tags = el('div', {className:'product-tags'});
      [p.team, p.kit, ...p.tags].forEach(t => {
        const tg = el('span', {className:'product-tag'}); tg.textContent = t; tags.appendChild(tg);
      });

      const actions = el('div', {className:'product-actions'});
      const view = el('button', {className:'btn btn-primary', type:'button'}); view.textContent = 'Ver';
      const add = el('button', {className:'btn btn-ghost', type:'button'}); add.textContent = 'Añadir';
      view.addEventListener('click', ()=> openModal(p));
      add.addEventListener('click', ()=> { state.cartCount++; $('#cartCount').textContent = state.cartCount; toast('Añadido al carrito'); });

      actions.append(view, add);
      info.append(meta, title, price, tags, actions);
      card.append(thumb, info);
      return card;
    }

    /* ==========
       Modal: abre y rellena datos del producto
    */
    function openModal(p){
      $('#modalTitle').textContent = p.name;
      $('#modalMeta').textContent = `${p.team} · ${p.league} · ${p.season}`;
      $('#modalTags').innerHTML = '';
      [p.kit, ...p.tags].forEach(t=>{ const s = el('span',{className:'product-tag'}); s.textContent = t; $('#modalTags').appendChild(s); });
      $('#modalPrice').textContent = p.price.toFixed(0) + '€';
      const media = $('#modalMedia'); media.innerHTML = ''; media.appendChild(jerseySVG());
      $('#modalProduct').classList.add('open');
      $('#modalProduct').setAttribute('aria-hidden','false');
      $('#modalProduct').style.display = 'flex';
    }
    function closeModal(){
      $('#modalProduct').classList.remove('open');
      $('#modalProduct').setAttribute('aria-hidden','true');
      $('#modalProduct').style.display = 'none';
    }

    /* ==========
       Mensaje breve (toast)
    */
    function toast(msg){
      const t = $('#toast-msg'); t.textContent = msg; t.classList.add('show');
      t.style.display = 'block';
      setTimeout(()=> { t.classList.remove('show'); t.style.display = 'none'; }, 1800);
    }

    function scrollToTop(){ window.scrollTo({top:0, behavior:'smooth'}); }

    // Inicializar la app
    init();
  </script>
</body>
</html>
